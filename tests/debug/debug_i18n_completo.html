<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <title>ğŸ” Debug i18n - Quest4Couple</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .status {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .ok { border-left-color: #28a745; }
        .error { border-left-color: #dc3545; }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 1em;
        }
        button:hover { background: #5568d3; }
        pre {
            background: #2d2d2d;
            color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        h2 { color: #764ba2; }
    </style>
</head>
<body>
    <h1>ğŸ” Debug Sistema i18n</h1>
    
    <div class="status">
        <h2>ğŸ“Š Estado Atual</h2>
        <p><strong>Idioma atual:</strong> <span id="currentLang">carregando...</span></p>
        <p><strong>Idioma guardado:</strong> <span id="savedLang">carregando...</span></p>
        <p><strong>TraduÃ§Ãµes carregadas:</strong> <span id="translationsLoaded">carregando...</span></p>
    </div>
    
    <div class="status">
        <h2>ğŸ¯ Trocar Idioma</h2>
        <button onclick="testLanguage('pt-pt')">ğŸ‡µğŸ‡¹ PT-PT</button>
        <button onclick="testLanguage('pt-br')">ğŸ‡§ğŸ‡· PT-BR</button>
        <button onclick="testLanguage('en')">ğŸ‡¬ğŸ‡§ EN</button>
        <button onclick="testLanguage('es')">ğŸ‡ªğŸ‡¸ ES</button>
        <button onclick="testLanguage('fr')">ğŸ‡«ğŸ‡· FR</button>
    </div>
    
    <div class="status">
        <h2>ğŸ“ Elemento de Teste</h2>
        <h1 id="testTitle" data-i18n="home.heroTitle" style="color: #764ba2;">
            (aguardando traduÃ§Ã£o...)
        </h1>
        <p id="testSubtitle" data-i18n-html="home.heroSubtitle" style="font-size: 1.1em;">
            (aguardando traduÃ§Ã£o...)
        </p>
    </div>
    
    <div class="status">
        <h2>ğŸ” TraduÃ§Ã£o EspecÃ­fica: home.heroTitle</h2>
        <pre id="heroTitleTranslations">(carregando...)</pre>
    </div>
    
    <div class="status">
        <h2>ğŸ“‹ Log de Eventos</h2>
        <pre id="log"></pre>
    </div>
    
    <script src="../js/i18n.js"></script>
    <script>
        let logDiv = document.getElementById('log');
        
        function log(msg) {
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${msg}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(msg);
        }
        
        async function testLanguage(lang) {
            log(`ğŸ”„ Trocando para ${lang}...`);
            
            try {
                await window.I18n.setLanguage(lang);
                log(`âœ… Idioma trocado para ${lang}`);
                updateStatus();
                await checkTranslations();
            } catch (error) {
                log(`âŒ Erro ao trocar idioma: ${error.message}`);
            }
        }
        
        function updateStatus() {
            document.getElementById('currentLang').textContent = window.I18n.currentLang;
            document.getElementById('savedLang').textContent = localStorage.getItem('quest4couple_lang') || '(nenhum)';
            document.getElementById('translationsLoaded').textContent = Object.keys(window.I18n.translations).length + ' chaves';
        }
        
        async function checkTranslations() {
            log('ğŸ” Verificando traduÃ§Ãµes de home.heroTitle em todos os idiomas...');
            
            const langs = ['pt-pt', 'pt-br', 'en', 'es', 'fr'];
            let output = '';
            
            for (const lang of langs) {
                try {
                    const response = await fetch(`../i18n/translations.${lang}.json`);
                    const data = await response.json();
                    const heroTitle = data.home?.heroTitle || 'âŒ NÃƒO EXISTE';
                    output += `${lang.toUpperCase()}: ${heroTitle}\n`;
                    
                    if (!data.home?.heroTitle) {
                        log(`âŒ FALTA: home.heroTitle em ${lang}`);
                    }
                } catch (error) {
                    output += `${lang.toUpperCase()}: âŒ ERRO: ${error.message}\n`;
                    log(`âŒ Erro ao carregar ${lang}: ${error.message}`);
                }
            }
            
            document.getElementById('heroTitleTranslations').textContent = output;
            
            // Verificar elemento atual
            const testTitle = document.getElementById('testTitle');
            log(`ğŸ“ Texto atual do elemento: "${testTitle.textContent}"`);
            
            const translation = window.I18n.t('home.heroTitle');
            log(`ğŸ”¤ TraduÃ§Ã£o retornada por I18n.t(): "${translation}"`);
        }
        
        // Quando i18n inicializar
        document.addEventListener('DOMContentLoaded', async () => {
            log('ğŸš€ PÃ¡gina carregada');
            
            // Aguardar inicializaÃ§Ã£o
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            log('ğŸ”§ Sistema i18n inicializado');
            updateStatus();
            await checkTranslations();
        });
        
        // Escutar mudanÃ§as de idioma
        document.addEventListener('languageChanged', (e) => {
            log(`ğŸŒ Evento languageChanged disparado: ${e.detail?.lang || 'sem detalhes'}`);
            updateStatus();
        });
    </script>
</body>
</html>
