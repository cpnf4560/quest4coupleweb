<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Quest4Couple - Sistema para Casais üíï</title>

<!-- Favicons -->
<link rel="icon" href="./favicon.ico" sizes="any">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
<link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
<style>
body { 
  font-family: Arial, sans-serif; 
  margin: 8px; 
  background: 
    radial-gradient(circle at 15% 25%, rgba(214, 51, 132, 0.35) 0%, transparent 35%),
    radial-gradient(circle at 85% 75%, rgba(111, 66, 193, 0.30) 0%, transparent 35%),
    radial-gradient(circle at 50% 10%, rgba(38, 198, 218, 0.20) 0%, transparent 35%),
    radial-gradient(circle at 20% 70%, rgba(232, 62, 140, 0.15) 0%, transparent 30%),
    repeating-linear-gradient(
      45deg,
      transparent,
      transparent 15px,
      rgba(255, 255, 255, 0.08) 15px,
      rgba(255, 255, 255, 0.08) 17px
    ),
    repeating-linear-gradient(
      -45deg,
      transparent,
      transparent 30px,
      rgba(214, 51, 132, 0.03) 30px,
      rgba(214, 51, 132, 0.03) 32px
    ),
    linear-gradient(135deg, #e8ecf0 0%, #d1d9e0 100%);
  font-size: 16px; 
  min-height: 100vh;
}
.header { 
  text-align: center; 
  margin-bottom: 20px;
  position: relative;
}

.header::before {
  content: '';
  position: absolute;
  top: -20px;
  left: 0;
  right: 0;
  height: 250px;
  background: 
    radial-gradient(circle at 50% 50%, rgba(214, 51, 132, 0.4) 2px, transparent 2px),
    radial-gradient(circle at 25% 25%, rgba(111, 66, 193, 0.3) 1px, transparent 1px),
    radial-gradient(circle at 75% 75%, rgba(38, 198, 218, 0.25) 1.5px, transparent 1.5px);
  background-size: 40px 40px, 20px 20px, 60px 60px;
  opacity: 0.7;
  z-index: -1;
  pointer-events: none;
}
.logo-section { margin-bottom: 25px; }
.logo { 
  width: 120px; 
  height: auto;
  max-height: 120px;
  margin-bottom: 10px;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
  object-fit: contain;
  cursor: pointer;
}
.logo-section h1 {
  margin: 10px 0 5px 0; 
  font-size: 28px; 
  color: #d63384;
  font-weight: bold;
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.tagline { 
  margin: 0; 
  font-size: 16px; 
  color: #6f42c1; 
  font-style: italic;
}
.user-section { margin: 20px 0; }
.user-section label { font-weight: bold; font-size: 16px; color: #495057; }
.user-section input { font-size: 16px; padding: 8px; }
.controls { display: flex; gap: 8px; justify-content: center; margin-bottom: 25px; flex-wrap: wrap; }
.compatibility-section { margin: 20px 0; padding: 20px; border-radius: 10px; }
.super-match { background-color: #d4edda; border-left: 5px solid #28a745; }
.match { background-color: #d1ecf1; border-left: 5px solid #17a2b8; }
.maybe { background-color: #fff3cd; border-left: 5px solid #ffc107; }
.special { background-color: #f8d7da; border-left: 5px solid #dc3545; }
.btn { background: linear-gradient(135deg, #d63384, #e83e8c); color: white; border: none; padding: 12px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; touch-action: manipulation; box-shadow: 0 2px 4px rgba(214, 51, 132, 0.3); transition: all 0.3s ease; }
.btn:hover { background: linear-gradient(135deg, #b02a5b, #d63384); transform: translateY(-1px); box-shadow: 0 4px 8px rgba(214, 51, 132, 0.4); }
.btn-secondary { background: linear-gradient(135deg, #6f42c1, #8e5cc7); }
.btn-secondary:hover { background: linear-gradient(135deg, #5a2d91, #6f42c1); transform: translateY(-1px); }

.btn-credits {
  background: linear-gradient(135deg, #28a745, #20c997);
  box-shadow: 0 2px 4px rgba(40, 167, 69, 0.3);
}
.btn-credits:hover {
  background: linear-gradient(135deg, #218838, #1fa080);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(40, 167, 69, 0.4);
}



/* Theme Cards Grid */
.themes-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 25px;
  margin: 30px 0;
  padding: 0 10px;
  animation: fadeInGrid 0.6s ease-out;
}

@keyframes fadeInGrid {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.theme-card {
  background: white;
  border-radius: 20px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  border: 2px solid transparent;
  position: relative;
}

.theme-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(214, 51, 132, 0.1), rgba(111, 66, 193, 0.1));
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}

.theme-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 35px rgba(0,0,0,0.2);
  border-color: rgba(214, 51, 132, 0.3);
}

.theme-card:hover::after {
  opacity: 1;
}

.theme-card:active {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.theme-card-header {
  padding: 40px 25px;
  text-align: center;
  color: white;
  position: relative;
  overflow: hidden;
}

.theme-card-header::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.3; }
  50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.1; }
}

.theme-icon {
  font-size: 3.5em;
  margin-bottom: 15px;
  display: block;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
}

.theme-card-header h3 {
  margin: 0 0 8px 0;
  font-size: 1.5em;
  font-weight: bold;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.theme-description {
  font-size: 0.9em;
  opacity: 0.95;
  line-height: 1.4;
}

.theme-card-footer {
  padding: 20px 25px;
  background: rgba(0,0,0,0.03);
  display: flex;
  flex-direction: column;
  gap: 10px;
  font-size: 0.85em;
  color: #666;
}

.footer-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.question-count {
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 5px;
}

.theme-cost {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 0.85em;
  color: #d63384;
  font-weight: 700;
  background: rgba(214, 51, 132, 0.1);
  padding: 4px 10px;
  border-radius: 12px;
  border: 1px solid rgba(214, 51, 132, 0.2);
}

.expand-hint {
  font-style: italic;
  color: #999;
  font-size: 0.9em;
}

/* Progress indicator */
.theme-progress {
  margin-top: 8px;
  height: 4px;
  background: rgba(0,0,0,0.1);
  border-radius: 2px;
  overflow: hidden;
}

.theme-progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #d63384, #e83e8c);
  width: 0%;
  transition: width 0.3s ease;
}

/* Expanded Theme View */
.pack { 
  margin-bottom: 20px; 
  border-radius: 20px; 
  color: white; 
  overflow: hidden; 
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255, 255, 255, 0.3);
  display: none;
}

.pack.active {
  display: block;
  animation: slideIn 0.4s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.pack-header { 
  padding: 25px 30px; 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  user-select: none;
  border-bottom: 2px solid rgba(255,255,255,0.2);
}

.pack-header h2 { 
  margin: 0; 
  font-size: 1.8em; 
  flex: 1;
  display: flex;
  align-items: center;
  gap: 15px;
}

.back-btn {
  background: rgba(255,255,255,0.2);
  border: 2px solid rgba(255,255,255,0.4);
  color: white;
  padding: 10px 20px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 0.9em;
  font-weight: 600;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
}

.back-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: translateX(-3px);
}

.pack-content { 
  max-height: none; 
  overflow: visible; 
  padding: 20px 0;
}
.romantico { background: linear-gradient(135deg, #ff6b9d, #e83e8c); }
.experiencia { background: linear-gradient(135deg, #a17fe0, #6f42c1); }
.pimentinha { background: linear-gradient(135deg, #ff4081, #d63384); }
.atrevimento { background: linear-gradient(135deg, #ff7043, #e64a19); }
.subdom { background: linear-gradient(135deg, #8e24aa, #673ab7); }
.kinks { background: linear-gradient(135deg, #c62828, #ad1457); }
.poliamor { background: linear-gradient(135deg, #26c6da, #00acc1); }

.question { 
  margin: 5px 15px; 
  padding: 0;
  background-color: transparent;
  border-radius: 0;
  display: block;
  min-height: auto;
}

.question-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 12px 15px;
  background-color: rgba(255,255,255,0.15);
  border-radius: 8px;
  margin-bottom: 5px;
}

.question-content {
  flex: 1;
  display: flex;
  align-items: center;
}

.question-text { 
  font-weight: 500; 
  line-height: 1.4; 
  font-size: 15px; 
  margin: 0;
  color: white;
}

.category-title {
  margin-top: 25px;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 2px solid rgba(255, 255, 255, 0.3);
  font-size: 1.3em;
  color: white;
  font-weight: 700;
  padding-left: 15px;
  text-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

.question-options { 
  display: flex; 
  justify-content: flex-end;
  align-items: center; 
  gap: 20px;
  flex-shrink: 0;
  min-width: 320px;
}

/* Estilo das op√ß√µes individuais */
.option-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
}

.option-label {
  font-size: 11px;
  font-weight: 600;
  text-align: center;
  color: white;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.question-options input[type="radio"] { 
  width: 22px; 
  height: 22px; 
  cursor: pointer;
  accent-color: white;
}

.question-comment {
  width: 100%;
  padding: 0 15px 8px 15px;
}

.question-comment textarea {
  width: 100%; 
  height: 40px; 
  padding: 8px 12px; 
  border-radius: 5px; 
  border: 1px solid rgba(255, 255, 255, 0.3);
  background-color: rgba(255, 255, 255, 0.1);
  color: white;
  resize: vertical; 
  font-size: 13px; 
  min-height: 40px;
  font-family: inherit;
  box-sizing: border-box;
}

.question-comment textarea::placeholder {
  color: rgba(255, 255, 255, 0.6);
  font-style: italic;
}

.comments textarea { 
  width: 100%; 
  height: 35px; 
  padding: 8px; 
  border-radius: 5px; 
  border: 1px solid #ccc; 
  resize: vertical; 
  font-size: 14px; 
  min-height: 35px;
  font-family: inherit;
}

h1 { margin: 10px 0 15px 0; font-size: 24px; }
.collapsed .toggle-icon { transform: rotate(-90deg); }

/* Responsividade Mobile */
@media (max-width: 768px) {
  body { margin: 5px; font-size: 16px; }
  .logo { width: 80px; height: 80px; }
  .logo-section h1 { font-size: 22px; }
  .tagline { font-size: 14px; }
  .controls { gap: 5px; }
  .btn { padding: 10px 12px; font-size: 13px; }
  
  /* Theme Cards Mobile */
  .themes-grid {
    grid-template-columns: 1fr;
    gap: 15px;
    padding: 0 5px;
  }
  
  .theme-card-header {
    padding: 30px 20px;
  }
  
  .theme-icon {
    font-size: 2.5em;
  }
  
  .theme-card-header h3 {
    font-size: 1.3em;
  }
  
  .theme-description {
    font-size: 0.85em;
  }
  
  .question { margin: 5px 10px; }
  .question-row { padding: 10px; }
  .question-text { font-size: 14px; }
  .option-label { 
    font-size: 10px;
  }
  
  .question-options input[type="radio"] { 
    width: 18px; 
    height: 18px; 
  }
  
  .pack-header { padding: 12px 15px; }
  .pack-header h2 { font-size: 16px; }
  
  .back-btn {
    padding: 8px 15px;
    font-size: 0.8em;
  }
}

@media (max-width: 480px) {
  .question-row {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .question-options {
    justify-content: space-around;
    gap: 15px;
  }
  
  .question-comment {
    padding: 0 10px 8px 10px;
  }
}

@media print {
  .controls { display: none; }
  .pack { page-break-inside: avoid; }
}

/* Age Verification Modal */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
  z-index: 10000;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease;
}

.modal-overlay.active {
  display: flex;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.age-modal {
  background: white;
  border-radius: 20px;
  padding: 40px;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 20px 60px rgba(0,0,0,0.4);
  text-align: center;
  animation: slideUp 0.4s ease;
}

@keyframes slideUp {
  from { 
    opacity: 0;
    transform: translateY(30px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

.age-modal-icon {
  font-size: 4em;
  margin-bottom: 20px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.age-modal h2 {
  color: #d63384;
  font-size: 2em;
  margin-bottom: 15px;
}

.age-modal p {
  color: #495057;
  font-size: 1.1em;
  line-height: 1.6;
  margin-bottom: 30px;
}

.age-buttons {
  display: flex;
  gap: 15px;
  margin-top: 30px;
}

.age-btn {
  flex: 1;
  padding: 15px 30px;
  border: none;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.age-btn-yes {
  background: linear-gradient(135deg, #28a745, #20c997);
  color: white;
}

.age-btn-yes:hover {
  background: linear-gradient(135deg, #218838, #1fa080);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(40, 167, 69, 0.3);
}

.age-btn-no {
  background: linear-gradient(135deg, #dc3545, #c82333);
  color: white;
}

.age-btn-no:hover {
  background: linear-gradient(135deg, #c82333, #bd2130);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(220, 53, 69, 0.3);
}

.age-warning {
  margin-top: 20px;
  padding: 15px;
  background: rgba(220, 53, 69, 0.1);
  border-left: 4px solid #dc3545;
  border-radius: 8px;
  font-size: 0.9em;
  color: #721c24;
}

/* Couple Type Selection */
.couple-config-section {
  margin: 30px auto;
  max-width: 900px;
  padding: 0 15px;
}

.couple-config-header {
  text-align: center;
  margin-bottom: 30px;
}

.couple-config-header h2 {
  color: #d63384;
  font-size: 2em;
  margin-bottom: 10px;
}

.couple-config-header p {
  color: #6c757d;
  font-size: 1.1em;
}

.couple-types-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 25px;
}

.couple-type-card {
  background: white;
  border-radius: 15px;
  padding: 30px 20px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  border: 3px solid transparent;
}

.couple-type-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.couple-type-card.selected {
  border-color: #d63384;
  background: linear-gradient(135deg, rgba(214, 51, 132, 0.05), rgba(111, 66, 193, 0.05));
  box-shadow: 0 8px 25px rgba(214, 51, 132, 0.3);
}

.couple-type-icon {
  font-size: 3.5em;
  margin-bottom: 15px;
  display: block;
}

.couple-type-card h3 {
  color: #495057;
  font-size: 1.2em;
  margin-bottom: 8px;
}

.couple-type-card p {
  color: #6c757d;
  font-size: 0.9em;
  line-height: 1.4;
}

.couple-type-card.selected h3 {
  color: #d63384;
  font-weight: bold;
}

.continue-btn {
  display: block;
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
  padding: 15px 30px;
  background: linear-gradient(135deg, #d63384, #e83e8c);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(214, 51, 132, 0.3);
}

.continue-btn:hover {
  background: linear-gradient(135deg, #b02a5b, #d63384);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(214, 51, 132, 0.4);
}

.continue-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.skip-config {
  text-align: center;
  margin-top: 15px;
}

.skip-config a {
  color: #6c757d;
  text-decoration: none;
  font-size: 0.95em;
  transition: color 0.2s;
}

.skip-config a:hover {
  color: #d63384;
  text-decoration: underline;
}

</style>
</head>
<body>

<!-- Age Verification Modal -->
<div class="modal-overlay active" id="ageModal">
  <div class="age-modal">
    <div class="age-modal-icon">üîû</div>
    <h2>Verifica√ß√£o de Idade</h2>
    <p>Este site cont√©m conte√∫do adulto.<br>Tens 18 anos ou mais?</p>
    
    <div class="age-buttons">
      <button class="age-btn age-btn-yes" onclick="confirmAge(true)">
        ‚úì Sim, tenho +18
      </button>
      <button class="age-btn age-btn-no" onclick="confirmAge(false)">
        ‚úó N√£o, sou menor
      </button>
    </div>
    
    <div class="age-warning">
      ‚ö†Ô∏è Ao confirmar, declaras que tens idade legal para aceder a este conte√∫do.
    </div>
  </div>
</div>

<div class="header">  <div class="logo-section">
    <a href="index.html">
      <img src="./logo.png" alt="Quest4Couple Logo" class="logo" onerror="this.src='./logo.jpg'; this.onerror=null;">
    </a>
    <h1>Quest4Couple</h1>
    <p class="tagline">Descubram-se juntos üíï</p>
  </div>
    <div class="user-section">
    <label for="userName">üë§ O Vosso Nome:</label>
    <input type="text" id="userName" placeholder="Introduzam o vosso nome..." style="margin: 0 10px; padding: 5px; border-radius: 3px; border: 1px solid #ccc;">
  </div>  <div class="controls" id="mainControls">
    <button class="btn btn-credits" onclick="window.location.href='creditos.html'">üíé Comprar Cr√©ditos</button>
    <button class="btn" onclick="saveAnswers()">üíæ Guardar Respostas Encriptadas</button>
    <button class="btn" onclick="showCompareSection()">üîÄ Comparar com Parceiro/a</button>
    <button class="btn btn-secondary" onclick="generatePDF()">üìÑ Gerar PDF</button>
    <button class="btn btn-secondary" onclick="sendByEmail()">üìß Enviar por E-mail</button>
  </div><div id="compareSection" style="display: none; margin: 15px 0; padding: 15px; background: #e9ecef; border-radius: 8px;">
    <h3>üîç Comparar Respostas do Casal</h3>
    <div style="margin: 10px 0;">
      <label>üìÅ Carregar o VOSSO ficheiro .q4c:</label>
      <input type="file" id="myFile" accept=".q4c" style="margin-left: 10px;">
    </div>    <div style="margin: 10px 0;">
      <label>üìÅ Carregar ficheiro .q4c do/a parceiro/a:</label>
      <input type="file" id="partnerFile" accept=".q4c" style="margin-left: 10px;">
    </div>
    <div style="margin: 10px 0;">
      <label>üîë C√≥digo de seguran√ßa:</label>
      <input type="password" id="securityCode" placeholder="Introduzam o c√≥digo utilizado..." style="margin-left: 10px; padding: 5px; border-radius: 3px; border: 1px solid #ccc;">
    </div>
    <button class="btn" onclick="compareEncryptedAnswers()">üéØ Gerar Relat√≥rio de Compatibilidade</button>
    
    <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px; font-size: 11px;">
      üí° <strong>Como funciona:</strong><br>
      1. Cada pessoa responde no seu PC e gera um ficheiro .q4c<br>
      2. Partilham os ficheiros entre si (e-mail, WhatsApp, etc.)<br>
      3. Qualquer um pode carregar ambos os ficheiros aqui e ver o relat√≥rio<br>
      4. Utilizem o mesmo c√≥digo de seguran√ßa que definiram ao guardar
    </div>
  </div>
    <div id="compatibilityReport" style="display: none;">  </div>
</div>

<!-- Couple Type Configuration -->
<div class="couple-config-section" id="coupleConfig">
  <div class="couple-config-header">
    <h2>üë´ Configura√ß√£o do Casal</h2>
    <p>Seleciona o tipo de rela√ß√£o para personalizar as perguntas</p>
  </div>
  
  <div class="couple-types-grid">
    <div class="couple-type-card" onclick="selectCoupleType('hetero')">
      <span class="couple-type-icon">üë®‚Äç‚ù§Ô∏è‚Äçüë©</span>
      <h3>Homem + Mulher</h3>
      <p>Casal heterossexual</p>
    </div>
    
    <div class="couple-type-card" onclick="selectCoupleType('lesbian')">
      <span class="couple-type-icon">üë©‚Äç‚ù§Ô∏è‚Äçüë©</span>
      <h3>Mulher + Mulher</h3>
      <p>Casal l√©sbico</p>
    </div>
    
    <div class="couple-type-card" onclick="selectCoupleType('gay')">
      <span class="couple-type-icon">üë®‚Äç‚ù§Ô∏è‚Äçüë®</span>
      <h3>Homem + Homem</h3>
      <p>Casal gay</p>
    </div>
    
    <div class="couple-type-card" onclick="selectCoupleType('other')">
      <span class="couple-type-icon">üåà</span>
      <h3>Outro / Todas</h3>
      <p>N√£o-bin√°rio ou ver tudo</p>
    </div>
  </div>
  
  <button class="continue-btn" id="continueBtn" onclick="continueToThemes()" disabled>
    Continuar ‚Üí
  </button>
  
  <div class="skip-config">
    <a href="#" onclick="skipConfig(); return false;">Pular configura√ß√£o (ver todas as perguntas)</a>
  </div>
</div>

<!-- Theme Selection Grid -->
<div id="themesView" class="themes-grid" style="display: none;">  <div class="theme-card" onclick="showTheme('romantico')">
    <div class="theme-card-header romantico">
      <span class="theme-icon">‚ù§Ô∏è</span>
      <h3>Rom√¢ntico & Fantasias</h3>
      <p class="theme-description">Velas, sedu√ß√£o, conex√£o profunda e momentos especiais a dois</p>
    </div>
    <div class="theme-card-footer">
      <div class="footer-content">
        <span class="question-count">üìù 30 perguntas</span>
        <span class="theme-cost">üíé 2 cr√©ditos</span>
      </div>
      <div class="theme-progress">
        <div class="theme-progress-bar"></div>
      </div>
    </div>
  </div>

  <div class="theme-card" onclick="showTheme('experiencia')">
    <div class="theme-card-header experiencia">
      <span class="theme-icon">üî•</span>
      <h3>Experi√™ncia a 2</h3>
      <p class="theme-description">Aventuras, locais diferentes e novas experi√™ncias juntos</p>
    </div>
    <div class="theme-card-footer">
      <div class="footer-content">
        <span class="question-count">üìù 30 perguntas</span>
        <span class="theme-cost">üíé 2 cr√©ditos</span>
      </div>
      <div class="theme-progress">
        <div class="theme-progress-bar"></div>
      </div>
    </div>
  </div>

  <div class="theme-card" onclick="showTheme('pimentinha')">
    <div class="theme-card-header pimentinha">
      <span class="theme-icon">üå∂Ô∏è</span>
      <h3>Pimentinha</h3>
      <p class="theme-description">Adicione tempero, provoca√ß√£o e jogos sensuais</p>
    </div>
    <div class="theme-card-footer">
      <div class="footer-content">
        <span class="question-count">üìù 30 perguntas</span>
        <span class="theme-cost">üíé 2 cr√©ditos</span>
      </div>
      <div class="theme-progress">
        <div class="theme-progress-bar"></div>
      </div>
    </div>
  </div>

  <div class="theme-card" onclick="showTheme('poliamor')">
    <div class="theme-card-header poliamor">
      <span class="theme-icon">üíû</span>
      <h3>Poliamor</h3>
      <p class="theme-description">M√∫ltiplos parceiros, swing e experi√™ncias em grupo</p>
    </div>
    <div class="theme-card-footer">
      <div class="footer-content">
        <span class="question-count">üìù 50 perguntas</span>
        <span class="theme-cost">üíé 3 cr√©ditos</span>
      </div>
      <div class="theme-progress">
        <div class="theme-progress-bar"></div>
      </div>
    </div>
  </div>

  <div class="theme-card" onclick="showTheme('kinks')">
    <div class="theme-card-header kinks">
      <span class="theme-icon">üé≠</span>
      <h3>Kinks & Fetiches</h3>
      <p class="theme-description">Fetiches espec√≠ficos, pr√°ticas avan√ßadas e prefer√™ncias √∫nicas</p>
    </div>
    <div class="theme-card-footer">
      <div class="footer-content">
        <span class="question-count">üìù 110 perguntas</span>
        <span class="theme-cost">üíé 3 cr√©ditos</span>
      </div>
      <div class="theme-progress">
        <div class="theme-progress-bar"></div>
      </div>
    </div>
  </div>
</div>

<!-- Pack Individual Pages -->

<!-- Pack Pack Rom√¢ntico -->
<div class="pack romantico" id="pack-romantico">
  <div class="pack-header" style="background: linear-gradient(135deg, #ff6b9d, #e83e8c);"></div>
    <h2>üíñ Pack Rom√¢ntico</h2>
    <button class="back-btn" onclick="backToThemes()">‚Üê Voltar</button>
  </div>
  <div class="pack-content" id="pack-romantico-questions">
    <!-- As perguntas ser√£o geradas aqui pelo JavaScript -->
  </div>
</div>

<!-- Pack Explora√ß√£o e Aventura a Dois -->
<div class="pack experiencia" id="pack-experiencia">
  <div class="pack-header" style="background: linear-gradient(135deg, #ffa726, #ff9800);">
    <h2>üó∫Ô∏è Explora√ß√£o e Aventura a Dois</h2>
    <button class="back-btn" onclick="backToThemes()">‚Üê Voltar</button>
  </div>
  <div class="pack-content" id="pack-experiencia-questions">
    <!-- As perguntas ser√£o geradas aqui pelo JavaScript -->
  </div>
</div>

<!-- Pack Pimentinha -->
<div class="pack pimentinha" id="pack-pimentinha">
  <div class="pack-header" style="background: linear-gradient(135deg, #ef5350, #f44336);">
    <h2>üå∂Ô∏è Pimentinha</h2>
    <button class="back-btn" onclick="backToThemes()">‚Üê Voltar</button>
  </div>
  <div class="pack-content" id="pack-pimentinha-questions">
    <!-- As perguntas ser√£o geradas aqui pelo JavaScript -->
  </div>
</div>

<!-- Pack Poliamor -->
<div class="pack poliamor" id="pack-poliamor">
  <div class="pack-header" style="background: linear-gradient(135deg, #26c6da, #00acc1);">
    <h2>üë• Poliamor</h2>
    <button class="back-btn" onclick="backToThemes()">‚Üê Voltar</button>
  </div>
  <div class="pack-content" id="pack-poliamor-questions">
    <!-- As perguntas ser√£o geradas aqui pelo JavaScript -->
  </div>
</div>

<!-- Pack Fetiches -->
<div class="pack kinks" id="pack-kinks">
  <div class="pack-header" style="background: linear-gradient(135deg, #ec407a, #d81b60);">
    <h2>üîó Fetiches</h2>
    <button class="back-btn" onclick="backToThemes()">‚Üê Voltar</button>
  </div>
  <div class="pack-content" id="pack-kinks-questions">
    <!-- As perguntas ser√£o geradas aqui pelo JavaScript -->
  </div>
</div>

<script>
// ========================================
// AGE VERIFICATION SYSTEM
// ========================================

let selectedCoupleType = null;

// Check if user has already verified age (valid for 24 hours)
function checkAgeVerification() {
  const ageVerified = localStorage.getItem('quest4couple_age_verified');
  const verificationTime = localStorage.getItem('quest4couple_age_time');
  
  if (ageVerified === 'true' && verificationTime) {
    const hoursPassed = (Date.now() - parseInt(verificationTime)) / (1000 * 60 * 60);
    if (hoursPassed < 24) {
      // Still valid, hide modal
      document.getElementById('ageModal').classList.remove('active');
      return true;
    }
  }
  
  // Show modal
  document.getElementById('ageModal').classList.add('active');
  return false;
}

// Confirm age
function confirmAge(isAdult) {
  if (isAdult) {
    // User is 18+
    localStorage.setItem('quest4couple_age_verified', 'true');
    localStorage.setItem('quest4couple_age_time', Date.now().toString());
    
    // Hide modal with animation
    const modal = document.getElementById('ageModal');
    modal.style.opacity = '0';
    setTimeout(() => {
      modal.classList.remove('active');
      modal.style.opacity = '1';
    }, 300);
  } else {
    // User is under 18 - redirect to educational site
    alert('üòä Lamentamos, mas deves ter 18+ anos para aceder a este conte√∫do.\n\nSer√°s redirecionado para um site educativo.');
    window.location.href = 'https://www.educacao.gov.pt/';
  }
}

// ========================================
// COUPLE TYPE CONFIGURATION
// ========================================

function selectCoupleType(type) {
  selectedCoupleType = type;
  
  // Remove selected class from all cards
  document.querySelectorAll('.couple-type-card').forEach(card => {
    card.classList.remove('selected');
  });
  
  // Add selected class to clicked card
  event.currentTarget.classList.add('selected');
  
  // Enable continue button
  document.getElementById('continueBtn').disabled = false;
  
  // Store preference
  localStorage.setItem('quest4couple_couple_type', type);
}

function continueToThemes() {
  if (!selectedCoupleType) {
    alert('Por favor, seleciona o tipo de casal primeiro!');
    return;
  }
  
  // Hide couple config
  document.getElementById('coupleConfig').style.display = 'none';
  
  // Show themes
  document.getElementById('themesView').style.display = 'grid';
  
  // Apply filters based on couple type
  applyQuestionFilters(selectedCoupleType);
}

function skipConfig() {
  selectedCoupleType = 'other';
  localStorage.setItem('quest4couple_couple_type', 'other');
  
  // Hide couple config
  document.getElementById('coupleConfig').style.display = 'none';
  
  // Show themes
  document.getElementById('themesView').style.display = 'grid';
}

function applyQuestionFilters(type) {
  // Este ser√° implementado quando tivermos perguntas espec√≠ficas marcadas
  // Por enquanto, mostramos todas as perguntas
  console.log('Couple type selected:', type);
  
  // Futuro: ocultar perguntas com atributo data-exclude-for="gay" etc.
  // Exemplo: document.querySelectorAll('[data-exclude-for="' + type + '"]').forEach(q => q.style.display = 'none');
}

// Check on page load
window.addEventListener('DOMContentLoaded', function() {
  checkAgeVerification();
  // N√ÉO carregar as perguntas aqui - s√≥ quando o utilizador clicar num pack
  
  // Check if couple type was already selected
  const savedType = localStorage.getItem('quest4couple_couple_type');
  if (savedType) {
    selectedCoupleType = savedType;
    document.getElementById('coupleConfig').style.display = 'none';
    document.getElementById('themesView').style.display = 'grid';
  }
});

// ========================================
// THEME NAVIGATION
// ========================================

// Theme navigation
function showTheme(themeName) {
  // Carregar as perguntas na primeira vez que o utilizador abrir qualquer pack
  if (!window.questionsLoaded) {
    loadAndRenderAllPacks();
    window.questionsLoaded = true;
  }
  
  // Hide themes grid
  document.getElementById('themesView').style.display = 'none';
  
  // Hide main controls
  const mainControls = document.getElementById('mainControls');
  if (mainControls) {
    mainControls.style.display = 'none';
  }
  
  // Hide all packs
  document.querySelectorAll('.pack').forEach(pack => {
    pack.classList.remove('active');
  });
  
  // Show selected pack
  const selectedPack = document.querySelector('.pack.' + themeName);
  if (selectedPack) {
    selectedPack.classList.add('active');
  }
  
  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function backToThemes() {
  // Hide all packs
  document.querySelectorAll('.pack').forEach(pack => {
    pack.classList.remove('active');
  });
  
  // Show themes grid
  document.getElementById('themesView').style.display = 'grid';
  
  // Show main controls
  const mainControls = document.getElementById('mainControls');
  if (mainControls) {
    mainControls.style.display = 'flex';
  }
  
  // Update progress indicators
  updateThemeProgress();
  
  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Update theme progress indicators
function updateThemeProgress() {
  const themeClasses = ['romantico', 'experiencia', 'pimentinha', 'poliamor', 'kinks'];
  
  themeClasses.forEach(themeClass => {
    const pack = document.querySelector('.pack.' + themeClass);
    if (pack) {
      const questions = pack.querySelectorAll('.question');
      const answered = Array.from(questions).filter(q => 
        q.querySelector('input[type="radio"]:checked')
      ).length;
      
      const percentage = questions.length > 0 ? (answered / questions.length) * 100 : 0;
      
      // Update card footer with progress
      const themeCard = Array.from(document.querySelectorAll('.theme-card')).find(card => {
        const onclick = card.getAttribute('onclick');
        return onclick && onclick.includes(themeClass);
      });
      
      if (themeCard) {
        const footer = themeCard.querySelector('.theme-card-footer');
        let progressDiv = footer.querySelector('.theme-progress');
        
        if (!progressDiv) {
          progressDiv = document.createElement('div');
          progressDiv.className = 'theme-progress';
          progressDiv.innerHTML = '<div class="theme-progress-bar"></div>';
          footer.appendChild(progressDiv);
        }
        
        const progressBar = progressDiv.querySelector('.theme-progress-bar');
        progressBar.style.width = percentage + '%';
        
        // Update question count text
        const countSpan = footer.querySelector('.question-count');
        if (answered > 0) {
          countSpan.innerHTML = `üìù ${answered}/${questions.length} respondidas`;
        }
      }
    }
  });
}

function createQuestion(name, text, questionNumber) {
  return `<div class='question'>
    <div class='question-content'>
      <div class='question-text'><strong>${questionNumber}.</strong> ${text}</div>
      <textarea placeholder='Coment√°rios (opcional)'></textarea>
    </div>
    <div class='question-options'>
      <div class='option-item'>
        <div class='option-label'>Por favor!</div>
        <input type='radio' name='${name}' value='porfavor'>
      </div>
      <div class='option-item'>
        <div class='option-label'>Yup</div>
        <input type='radio' name='${name}' value='yup'>
      </div>
      <div class='option-item'>
        <div class='option-label'>Meh...</div>
        <input type='radio' name='${name}' value='meh'>
      </div>
      <div class='option-item'>
        <div class='option-label'>Talvez</div>
        <input type='radio' name='${name}' value='talvez'>
      </div>
    </div>
  </div>`;
}

// Fun√ß√£o createOptionsHeader removida - agora usamos labels individuais

// ========================================
// DYNAMIC QUESTION RENDERING
// ========================================

// Fun√ß√£o para carregar e renderizar packs dinamicamente
document.addEventListener('DOMContentLoaded', function () {
    loadAndRenderAllPacks();
});

function loadAndRenderAllPacks() {
    fetch('packs_data_clean.json')
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(packsData => {
            // Mapeamento dos IDs dos contentores para os nomes dos packs no JSON
            const packConfigs = [
                { id: 'romantico', containerId: 'pack-romantico-questions', name: 'Pack Rom√¢ntico' },
                { id: 'experiencia', containerId: 'pack-experiencia-questions', name: 'Explora√ß√£o e Aventura a Dois' },
                { id: 'pimentinha', containerId: 'pack-pimentinha-questions', name: 'Pimentinha' },
                { id: 'poliamor', containerId: 'pack-poliamor-questions', name: 'Poliamor' },
                { id: 'kinks', containerId: 'pack-kinks-questions', name: 'Fetiches' }
            ];

            packConfigs.forEach(config => {
                const packData = packsData.find(p => p.name === config.name);
                if (packData && packData.categories) {
                    renderPackQuestions(config.containerId, config.id, packData.categories);
                } else {
                    console.error(`Categorias do pack "${config.name}" n√£o encontradas no JSON.`);
                }
            });
        })
        .catch(err => {
            console.error('Erro fatal ao carregar ou renderizar os packs de perguntas:', err);
            // Opcional: Mostrar uma mensagem de erro ao utilizador na UI
            const mainView = document.getElementById('themesView');
            if(mainView) {
                mainView.innerHTML = `<div style="color: red; text-align: center; padding: 20px; background: #fff0f0; border: 1px solid red; border-radius: 8px;">
                                        <h3>Erro ao Carregar Perguntas</h3>
                                        <p>N√£o foi poss√≠vel carregar os question√°rios. Verifique a consola para mais detalhes e certifique-se que o ficheiro <code>packs_data_clean.json</code> existe e est√° acess√≠vel.</p>
                                     </div>`;
                mainView.style.display = 'grid';
            }
        });
}

function renderPackQuestions(containerId, packId, categories) {
    const container = document.getElementById(containerId);
    if (!container) {
        console.error(`Contentor com ID "${containerId}" n√£o foi encontrado.`);
        return;
    }

    container.innerHTML = ''; // Limpa conte√∫do antigo
    let questionCounter = 0; // Contador global para as perguntas do pack

    categories.forEach(category => {
        // Adiciona o t√≠tulo da categoria
        const categoryTitle = document.createElement('h3');
        categoryTitle.className = 'category-title'; // Adicionar uma classe para estiliza√ß√£o
        categoryTitle.textContent = category.name;
        container.appendChild(categoryTitle);

        if (category.questions && Array.isArray(category.questions)) {
            category.questions.forEach((questionText) => {
                questionCounter++;
                const qNum = questionCounter;
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';

                questionDiv.innerHTML = `
                    <div class="question-row">
                        <div class="question-content">
                            <div class="question-text"><strong>${qNum}.</strong> ${questionText}</div>
                        </div>
                        <div class="question-options">
                            <div class="option-item">
                                <span class="option-label">Por favor!</span>
                                <input type="radio" name="${packId}_q${qNum}" value="porfavor">
                            </div>
                            <div class="option-item">
                                <span class="option-label">Yup</span>
                                <input type="radio" name="${packId}_q${qNum}" value="yup">
                            </div>
                            <div class="option-item">
                                <span class="option-label">Meh...</span>
                                <input type="radio" name="${packId}_q${qNum}" value="meh">
                            </div>
                            <div class="option-item">
                                <span class="option-label">Talvez</span>
                                <input type="radio" name="${packId}_q${qNum}" value="talvez">
                            </div>
                        </div>
                    </div>
                    <div class="question-comment">
                        <textarea name="${packId}_q${qNum}_comment" placeholder="Coment√°rios (opcional)"></textarea>
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }
    });
}

// ========================================
// SAVE, LOAD, AND COMPARE SYSTEM
// ========================================

// Incluir a biblioteca CryptoJS para encripta√ß√£o
const cryptoScript = document.createElement('script');
cryptoScript.src = "https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js";
document.head.appendChild(cryptoScript);

function getAnswersData() {
    const data = {
        userName: document.getElementById('userName').value || 'An√≥nimo',
        answers: {},
        timestamp: new Date().toISOString()
    };

    const packConfigs = [
        { id: 'romantico', name: 'Pack Rom√¢ntico' },
        { id: 'experiencia', name: 'Explora√ß√£o e Aventura a Dois' },
        { id: 'pimentinha', name: 'Pimentinha' },
        { id: 'poliamor', name: 'Poliamor' },
        { id: 'kinks', name: 'Fetiches' }
    ];

    packConfigs.forEach(config => {
        const packContainer = document.getElementById(`pack-${config.id}-questions`);
        if (packContainer) {
            const questions = packContainer.querySelectorAll('.question');
            questions.forEach((q, index) => {
                const qNum = index + 1;
                const radio = q.querySelector(`input[name="${config.id}_q${qNum}"]:checked`);
                const comment = q.querySelector(`textarea[name="${config.id}_q${qNum}_comment"]`);
                
                if (radio || (comment && comment.value.trim() !== '')) {
                    if (!data.answers[config.id]) {
                        data.answers[config.id] = {};
                    }
                    data.answers[config.id][`q${qNum}`] = {
                        answer: radio ? radio.value : null,
                        comment: comment ? comment.value.trim() : ''
                    };
                }
            });
        }
    });

    return data;
}

function saveAnswers() {
    const securityCode = prompt("Por favor, introduza um c√≥digo de seguran√ßa para encriptar as suas respostas.\nLembre-se deste c√≥digo para comparar mais tarde.", "");
    if (!securityCode) {
        alert("C√≥digo de seguran√ßa √© obrigat√≥rio para guardar.");
        return;
    }

    const data = getAnswersData();
    const dataString = JSON.stringify(data);
    
    // Encrypt
    const encrypted = CryptoJS.AES.encrypt(dataString, securityCode).toString();

    const blob = new Blob([encrypted], { type: 'text/plain;charset=utf-8' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `Quest4Couple_${data.userName.replace(/ /g, '_')}_${new Date().toISOString().slice(0,10)}.q4c`;
    a.click();
    URL.revokeObjectURL(a.href);
    
    alert("Ficheiro com as respostas guardado com sucesso!");
}

function showCompareSection() {
    const section = document.getElementById('compareSection');
    section.style.display = section.style.display === 'none' ? 'block' : 'none';
}

async function compareEncryptedAnswers() {
    const myFileInput = document.getElementById('myFile');
    const partnerFileInput = document.getElementById('partnerFile');
    const securityCodeInput = document.getElementById('securityCode');
    const reportContainer = document.getElementById('compatibilityReport');

    if (!myFileInput.files[0] || !partnerFileInput.files[0] || !securityCodeInput.value) {
        alert("Por favor, carregue ambos os ficheiros e introduza o c√≥digo de seguran√ßa.");
        return;
    }

    try {
        const myFileContent = await myFileInput.files[0].text();
        const partnerFileContent = await partnerFileInput.files[0].text();

        // Decrypt
        const myDecrypted = CryptoJS.AES.decrypt(myFileContent, securityCodeInput.value).toString(CryptoJS.enc.Utf8);
        const partnerDecrypted = CryptoJS.AES.decrypt(partnerFileContent, securityCodeInput.value).toString(CryptoJS.enc.Utf8);

        if (!myDecrypted || !partnerDecrypted) {
            throw new Error("Falha na desencripta√ß√£o. Verifique o c√≥digo de seguran√ßa.");
        }

        const myData = JSON.parse(myDecrypted);
        const partnerData = JSON.parse(partnerDecrypted);

        generateCompatibilityReport(myData, partnerData);

    } catch (error) {
        console.error("Erro ao comparar:", error);
        reportContainer.innerHTML = `<div class="special" style="padding: 15px; border-radius: 8px;">
                                        <strong>Erro!</strong> N√£o foi poss√≠vel comparar os ficheiros. 
                                        Verifique se o c√≥digo de seguran√ßa est√° correto e se os ficheiros n√£o est√£o corrompidos.
                                     </div>`;
        reportContainer.style.display = 'block';
    }
}

async function generateCompatibilityReport(myData, partnerData) {
    const reportContainer = document.getElementById('compatibilityReport');
    let html = `<h2>üíñ Relat√≥rio de Compatibilidade entre ${myData.userName} e ${partnerData.userName}</h2>`;

    const allPacksResponse = await fetch('packs_data_clean.json');
    const allPacksData = await allPacksResponse.json();

    const packConfigs = [
        { id: 'romantico', name: 'Pack Rom√¢ntico' },
        { id: 'experiencia', name: 'Explora√ß√£o e Aventura a Dois' },
        { id: 'pimentinha', name: 'Pimentinha' },
        { id: 'poliamor', name: 'Poliamor' },
        { id: 'kinks', name: 'Fetiches' }
    ];
    
    let totalMatches = 0;
    let totalQuestions = 0;

    packConfigs.forEach(config => {
        const packData = allPacksData.find(p => p.name === config.name);
        if (!packData || !packData.categories) return;

        // Achatamos as perguntas para facilitar a busca pelo √≠ndice
        const packQuestions = packData.categories.flatMap(cat => cat.questions);

        const myAnswers = myData.answers[config.id] || {};
        const partnerAnswers = partnerData.answers[config.id] || {};
        const commonQuestions = { ...myAnswers, ...partnerAnswers };

        if (Object.keys(commonQuestions).length > 0) {
            html += `<div class="pack ${config.id}" style="display:block; margin-top: 20px;">
                        <div class="pack-header"><h2>${config.name}</h2></div>
                        <div class="pack-content">`;

            Object.keys(commonQuestions).sort((a, b) => parseInt(a.slice(1)) - parseInt(b.slice(1))).forEach(qKey => {
                const qIndex = parseInt(qKey.replace('q', '')) - 1;
                const questionText = packQuestions[qIndex];
                if (questionText === undefined) return;

                totalQuestions++;
                const myAns = myAnswers[qKey];
                const partnerAns = partnerAnswers[qKey];

                let compatibilityClass = 'maybe';
                let resultText = 'ü§î Interesse M√∫tuo por Explorar';

                if (myAns?.answer === 'yes' && partnerAns?.answer === 'yes') {
                    compatibilityClass = 'super-match';
                    resultText = 'üî• Super Match!';
                    totalMatches++;
                } else if (myAns?.answer === 'no' || partnerAns?.answer === 'no') {
                    compatibilityClass = 'special';
                    resultText = '‚ùå desalinhamento';
                } else if ((myAns?.answer === 'yes' && partnerAns?.answer === 'maybe') || (myAns?.answer === 'maybe' && partnerAns?.answer === 'yes')) {
                    compatibilityClass = 'match';
                    resultText = '‚úÖ Match!';
                }

                html += `<div class="compatibility-section ${compatibilityClass}">
                            <p><strong>${qIndex + 1}. ${questionText}</strong></p>
                            <p><em>${resultText}</em></p>
                            <p><strong>${myData.userName}:</strong> ${myAns ? getAnswerText(myAns.answer) : 'N√£o respondeu'} ${myAns?.comment ? `<em>(${myAns.comment})</em>` : ''}</p>
                            <p><strong>${partnerData.userName}:</strong> ${partnerAns ? getAnswerText(partnerAns.answer) : 'N√£o respondeu'} ${partnerAns?.comment ? `<em>(${partnerAns.comment})</em>` : ''}</p>
                         </div>`;
            });
            html += `</div></div>`;
        }
    });
    
    const overallCompatibility = totalQuestions > 0 ? Math.round((totalMatches / totalQuestions) * 100) : 0;
    html = `<h3>Compatibilidade Geral (Super Matches): ${overallCompatibility}%</h3>` + html;

    reportContainer.innerHTML = html;
    reportContainer.style.display = 'block';
    reportContainer.scrollIntoView({ behavior: 'smooth' });
}

</script>

</body>
</html>